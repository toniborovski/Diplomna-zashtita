:root{
  --bg-primary:#f8fafc;
  --bg-secondary:#ffffff;
  --text-primary:#1e293b;
  --text-secondary:#475569;
  --accent-primary:#1e40af;
  --accent-hover:#1d4ed8;
  --border-color:#e2e8f0;
  --shadow:0 10px 25px rgba(0,0,0,0.1);
  --chip-bg: rgba(255,255,255,0.75);
  --glass: rgba(255,255,255,0.85);
}

/* Dark mode */
html.dark{
  --bg-primary:#0b1220;
  --bg-secondary:#0f172a;
  --text-primary:#e5e7eb;
  --text-secondary:#9ca3af;
  --accent-primary:#60a5fa;
  --accent-hover:#93c5fd;
  --border-color:#1f2a44;
  --shadow:0 18px 40px rgba(0,0,0,0.35);
  --chip-bg: rgba(15,23,42,0.75);
  --glass: rgba(15,23,42,0.88);
}

*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{
  font-family:-apple-system,'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
  background:var(--bg-primary);
  color:var(--text-primary);
  overflow:hidden;
  -webkit-user-select:none;
  user-select:none;
  -webkit-touch-callout:none;
  touch-action:none;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  position:fixed;
  width:100%;
  height:100%;
}

.slide-container{
  width:100vw;height:100vh;position:relative;background:var(--bg-primary);
  overflow:hidden;
}

.slide{
  width:100%;height:100%;
  position:absolute;top:0;left:0;
  opacity:0;transform:translateX(100%);
  transition:all 0.6s cubic-bezier(0.25,0.46,0.45,0.94);
  padding:clamp(20px,5vw,80px);
  display:flex;flex-direction:column;justify-content:center;
  background:var(--bg-secondary);
  box-shadow:var(--shadow);
  overflow:auto;
  -webkit-overflow-scrolling:touch;
  overscroll-behavior:none;
}
.slide.active{opacity:1;transform:translateX(0)}
.slide.prev{transform:translateX(-100%)}

h1{font-size:3.2rem;font-weight:800;color:var(--text-primary);margin-bottom:1.5rem;line-height:1.1}
h2{font-size:2.5rem;font-weight:800;color:var(--accent-primary);margin-bottom:2rem}
h3{font-size:1.6rem;font-weight:800;color:var(--text-primary);margin-bottom:1rem}
p,li{font-size:1.3rem;font-weight:650;color:var(--text-primary);line-height:1.6;margin-bottom:1rem}

ul{list-style:none;padding-left:0}
li{position:relative;padding-left:2rem;margin-bottom:1.2rem}
li::before{content:"â–¸";position:absolute;left:0;color:var(--accent-primary);font-weight:900;font-size:1.4rem}

.content-grid{display:grid;grid-template-columns:1fr 1fr;gap:3rem;height:70%}
.content-left{display:flex;flex-direction:column;justify-content:center}

.image-placeholder{
  background:linear-gradient(135deg,#e2e8f0 0%,#cbd5e1 100%);
  border:3px dashed #94a3b3;
  border-radius:12px;
  height:300px;
  display:flex;align-items:center;justify-content:center;flex-direction:column;
  text-align:center;color:var(--text-secondary);
  cursor:pointer;
  user-select:none;
  transition:transform .15s ease, box-shadow .15s ease, border-color .15s ease;
}
html.dark .image-placeholder{
  background:linear-gradient(135deg,#111b31 0%,#0b1220 100%);
  border-color:#334155;
  color:var(--text-secondary);
}
.image-placeholder:hover{transform:translateY(-2px);box-shadow:0 10px 24px rgba(0,0,0,0.15);border-color:var(--accent-primary)}
.image-placeholder h4{font-size:1.1rem;margin-bottom:.5rem;color:var(--text-primary)}
.image-placeholder small{opacity:.8}

.stats-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:1.5rem;margin-top:2rem;
}
.stat-card{
  background:rgba(255,255,255,0.85);
  padding:2rem;border-radius:14px;
  border-left:5px solid var(--accent-primary);
  box-shadow:0 4px 12px rgba(0,0,0,0.08);
  text-align:center;
  backdrop-filter: blur(8px);
}
html.dark .stat-card{background:rgba(15,23,42,0.75)}
.stat-value{font-size:2.5rem;font-weight:900;color:var(--accent-primary);display:block}
.stat-label{font-size:1rem;color:var(--text-secondary);margin-top:.5rem}

.center-content{text-align:center;display:flex;flex-direction:column;justify-content:center;align-items:center;height:70%}
.highlight{color:var(--accent-primary);font-weight:900}

/* Top info row */
.topbar{
  position:fixed;top:max(8px,env(safe-area-inset-top));left:max(8px,env(safe-area-inset-left));right:max(8px,env(safe-area-inset-right));
  display:flex;align-items:center;justify-content:space-between;
  z-index:2000;
  pointer-events:none;
  flex-wrap:wrap;
  gap:8px;
}
.topbar .left, .topbar .right{
  display:flex;align-items:center;gap:clamp(8px,2vw,10px);
  pointer-events:auto;
}
.chip{
  background:var(--chip-bg);
  border:1px solid var(--border-color);
  padding:clamp(8px,2vh,10px) clamp(10px,2.5vw,14px);border-radius:999px;
  font-weight:850;font-size:clamp(0.75rem,2vw,1rem);color:var(--text-primary);
  backdrop-filter: blur(10px);
  box-shadow:0 10px 25px rgba(0,0,0,0.10);
  user-select:none;
  min-height:44px;
  display:flex;
  align-items:center;
  cursor:pointer;
  transition:background-color 0.2s ease,border-color 0.2s ease,transform 0.2s ease;
}
.chip:hover{
  background:rgba(148,163,184,0.15);
}
.chip:active{
  transform:scale(0.98);
}
.chip.mono{font-variant-numeric:tabular-nums}
.chip subtle{opacity:.8}

/* Progress bar */
.progress{
  position:fixed;left:0;top:0;height:6px;width:100%;
  background:rgba(226,232,240,0.9);z-index:2100;
}
html.dark .progress{background:rgba(31,42,68,0.9)}
.progress > div{
  height:100%;width:0%;
  background:var(--accent-primary);
  transition:width 0.25s ease;
}

/* Bottom navigation bar */
.nav{
  position:fixed;bottom:max(12px,env(safe-area-inset-bottom));left:50%;
  transform:translateX(-50%);
  z-index:2000;
  display:flex;gap:clamp(6px,1vw,10px);align-items:center;
  padding:clamp(8px,2vh,10px) clamp(10px,2vw,12px);border-radius:999px;
  background:var(--glass);
  border:1px solid var(--border-color);
  backdrop-filter: blur(10px);
  box-shadow:0 14px 30px rgba(0,0,0,0.14);
  flex-wrap:wrap;
  justify-content:center;
  transition:opacity 0.3s ease,visibility 0.3s ease;
}
.nav.hidden{
  opacity:0;
  visibility:hidden;
  pointer-events:none;
}
.nav-btn{
  background:var(--accent-primary);color:white;border:none;
  padding:clamp(10px,2.5vh,12px) clamp(12px,2.5vw,16px);border-radius:999px;
  font-size:clamp(0.85rem,2vw,1.02rem);font-weight:850;cursor:pointer;
  transition:all 0.2s ease;
  box-shadow:0 8px 18px rgba(30,64,175,0.25);
  user-select:none;
  white-space:nowrap;
  min-height:44px;
  min-width:44px;
  display:flex;
  align-items:center;
  justify-content:center;
  -webkit-appearance:none;
  appearance:none;
}
.nav-btn:hover{background:var(--accent-hover);transform:translateY(-1px)}
.nav-btn:active{transform:scale(0.98)}
.nav-btn:disabled{background:#94a3b3;cursor:not-allowed;transform:none;box-shadow:none}
html.dark .nav-btn:disabled{background:#475569}

.nav-ghost{
  background:transparent;color:var(--text-primary);
  border:1px solid var(--border-color);
  box-shadow:none;
  font-size:clamp(1rem,2vw,1.1rem);
}
.nav-ghost:hover{background:rgba(148,163,184,0.15)}
.nav-ghost:active{background:rgba(148,163,184,0.25)}
html.dark .nav-ghost:hover{background:rgba(148,163,184,0.10)}
html.dark .nav-ghost:active{background:rgba(148,163,184,0.20)}

select.jump{
  border:1px solid var(--border-color);
  background:transparent;
  padding:clamp(8px,2vh,10px) clamp(10px,2vw,12px);border-radius:999px;
  font-weight:850;color:var(--text-primary);
  outline:none;
  max-width:clamp(200px,60vw,260px);
  min-height:44px;
  cursor:pointer;
  -webkit-appearance:none;
  appearance:none;
  font-size:clamp(0.85rem,2vw,1rem);
}

/* Notes */
.notes{
  position:fixed;left:max(8px,env(safe-area-inset-left));top:clamp(50px,15vw,80px);z-index:2200;
  max-width:min(480px, 90vw);
  background:var(--glass);
  border:1px solid var(--border-color);
  border-radius:16px;
  box-shadow:0 18px 40px rgba(0,0,0,0.18);
  padding:clamp(12px,3vw,16px);
  display:none;
  backdrop-filter: blur(10px);
  max-height:45vh;
  overflow:auto;
  -webkit-overflow-scrolling:touch;
}
.notes h4{margin-bottom:8px;color:var(--accent-primary);font-size:clamp(0.9rem,2vw,1rem)}
.notes p{font-size:clamp(0.95rem,2vw,1.05rem);font-weight:650;color:var(--text-primary);margin-bottom:0}

/* Help overlay */
.overlay{
  position:fixed;inset:0;z-index:3000;
  background:rgba(0,0,0,0.55);
  display:none;
  align-items:center;justify-content:center;
  padding:clamp(12px,3vw,20px);
  overflow:auto;
  -webkit-overflow-scrolling:touch;
}
.panel{
  width:min(920px, 96vw);
  background:var(--bg-secondary);
  color:var(--text-primary);
  border:1px solid var(--border-color);
  border-radius:18px;
  box-shadow:0 26px 70px rgba(0,0,0,0.35);
  padding:clamp(14px,3vw,18px);
  max-height:86vh;
  overflow:auto;
  -webkit-overflow-scrolling:touch;
}
.panel h3{margin-bottom:12px;font-size:clamp(1.1rem,2.5vw,1.4rem)}
.panel .grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:clamp(8px,2vw,16px);
}
.kbd{
  display:flex;gap:clamp(8px,2vw,10px);align-items:flex-start;
  padding:clamp(8px,2vh,12px);border-radius:14px;
  border:1px solid var(--border-color);
  background:rgba(148,163,184,0.08);
  font-size:clamp(0.85rem,2vw,0.95rem);
}
html.dark .panel{background:var(--bg-secondary)}
.kbd code{
  background:rgba(30,64,175,0.12);
  border:1px solid rgba(30,64,175,0.25);
  padding:4px 8px;border-radius:10px;
  font-weight:900;
  color:var(--accent-primary);
}
.panel .row{
  display:flex;justify-content:space-between;align-items:center;
  margin-bottom:10px;
}

/* Overview grid */
.overview-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit, minmax(160px, 1fr));
  gap:clamp(8px,2vw,12px);
}
.thumb{
  border:1px solid var(--border-color);
  border-radius:14px;
  padding:clamp(10px,2vh,12px);
  background:rgba(148,163,184,0.08);
  cursor:pointer;
  transition:transform .12s ease, box-shadow .12s ease;
  user-select:none;
  min-height:100px;
  font-size:clamp(0.85rem,2vw,0.95rem);
  -webkit-user-select:none;
}
.thumb:hover{transform:translateY(-2px);box-shadow:0 12px 26px rgba(0,0,0,0.16)}
.thumb:active{transform:translateY(0px);box-shadow:0 4px 12px rgba(0,0,0,0.10)}
.thumb b{display:block;margin-bottom:4px;color:var(--accent-primary);font-size:clamp(0.85rem,2vw,1rem)}
.thumb span{color:var(--text-secondary);font-weight:650;font-size:clamp(0.75rem,1.5vw,0.9rem)}

/* Image/PDF modal */
.modal{
  position:fixed;inset:0;z-index:3500;
  background:rgba(0,0,0,0.62);
  display:none;
  align-items:center;justify-content:center;
  padding:clamp(12px,3vw,18px);
  overflow:auto;
  -webkit-overflow-scrolling:touch;
}
.modal-card{
  width:min(1200px, 96vw);
  height:min(86vh, 900px);
  background:var(--bg-secondary);
  border-radius:18px;
  border:1px solid var(--border-color);
  box-shadow:0 26px 70px rgba(0,0,0,0.40);
  overflow:hidden;
  display:flex;
  flex-direction:column;
}
.modal-top{
  display:flex;align-items:center;justify-content:space-between;
  padding:clamp(8px,2vh,12px);
  border-bottom:1px solid var(--border-color);
  background:rgba(148,163,184,0.08);
  flex-wrap:wrap;
  gap:8px;
}
.modal-actions{display:flex;gap:clamp(4px,1vw,8px);align-items:center;flex-wrap:wrap}
.icon-btn{
  border:1px solid var(--border-color);
  background:transparent;color:var(--text-primary);
  padding:clamp(8px,2vh,10px) clamp(8px,2vw,10px);border-radius:12px;
  cursor:pointer;font-weight:900;
  font-size:clamp(0.85rem,2vw,1rem);
  min-height:44px;
  min-width:44px;
  display:flex;
  align-items:center;
  justify-content:center;
  -webkit-appearance:none;
  appearance:none;
}
.icon-btn:hover{background:rgba(148,163,184,0.15)}
.icon-btn:active{background:rgba(148,163,184,0.25)}
.modal-body{
  flex:1;
  background:#0b1020;
  display:flex;align-items:center;justify-content:center;
  position:relative;
  overflow:hidden;
}
.modal-body img{
  max-width:none;
  transform-origin:center center;
  user-select:none;
  -webkit-user-drag:none;
}
.modal-body iframe{
  width:100%;height:100%;
  border:0;
  background:white;
}

/* Annotation / laser layers */
.layers{
  position:fixed;inset:0;z-index:2500;
  pointer-events:none;
}
#drawCanvas{
  width:100vw;height:100vh;
  pointer-events:none;
}
.laser-dot{
  position:fixed;
  width:16px;height:16px;border-radius:50%;
  background:rgba(255, 0, 0, 0.85);
  box-shadow:0 0 18px rgba(255,0,0,0.75);
  transform:translate(-50%,-50%);
  display:none;
  z-index:2600;
  pointer-events:none;
}

@media (max-width:1200px){
  h1{font-size:clamp(1.8rem,4.5vw,2.5rem)}
  h2{font-size:clamp(1.5rem,3.5vw,2rem)}
  h3{font-size:clamp(1.2rem,3vw,1.6rem)}
  p,li{font-size:clamp(0.95rem,2.2vw,1.15rem)}
  .content-grid{grid-template-columns:1fr;gap:clamp(1rem,2vh,1.5rem);height:auto}
  .center-content{height:auto}
  .nav{flex-wrap:wrap;justify-content:center;max-width:95vw}
  .image-placeholder{height:clamp(180px,40vh,300px)}
  .stats-grid{grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:clamp(1rem,1.5vw,1.5rem)}
}

@media (max-width:768px){
  h1{font-size:clamp(1.5rem,4vw,2rem)}
  h2{font-size:clamp(1.2rem,3vw,1.6rem)}
  h3{font-size:clamp(1rem,2.5vw,1.3rem)}
  p,li{font-size:clamp(0.9rem,2vw,1rem)}
  .topbar{flex-direction:column;gap:clamp(6px,1.5vh,10px)}
  .topbar .left,.topbar .right{justify-content:center}
  .nav{padding:clamp(6px,1.5vh,8px) clamp(8px,1.5vw,10px)}
  .notes{left:50%;transform:translateX(-50%);max-width:90vw}
  .image-placeholder{height:clamp(150px,30vh,250px)}
  .stats-grid{grid-template-columns:1fr}
  .modal-card{height:auto;max-height:90vh}
  .content-grid{gap:clamp(0.8rem,1.5vh,1.2rem)}
}

@media (max-width:480px){
  h1{font-size:clamp(1.3rem,3.5vw,1.8rem)}
  h2{font-size:clamp(1rem,2.5vw,1.4rem)}
  h3{font-size:clamp(0.9rem,2.2vw,1.1rem)}
  p,li{font-size:clamp(0.85rem,1.8vw,0.95rem)}
  .slide{padding:clamp(12px,4vw,20px)}
  .nav-btn{padding:clamp(8px,1.5vh,10px) clamp(8px,1.5vw,10px);font-size:clamp(0.7rem,1.5vw,0.85rem)}
  .chip{padding:clamp(6px,1.5vh,8px) clamp(8px,1.5vw,10px);font-size:clamp(0.7rem,1.5vw,0.85rem)}
  .topbar{gap:clamp(4px,1vh,6px)}
  .topbar .left,.topbar .right{gap:clamp(4px,1vw,6px)}
  .notes{max-width:95vw;padding:clamp(10px,2vh,12px)}
  .image-placeholder{height:clamp(120px,25vh,180px)}
}

/* Dark mode improvements for Windows */
@media (prefers-color-scheme:dark){
  html:not(.dark){
    --bg-primary:#0b1220;
    --bg-secondary:#0f172a;
    --text-primary:#e5e7eb;
    --text-secondary:#9ca3af;
    --accent-primary:#60a5fa;
    --accent-hover:#93c5fd;
    --border-color:#1f2a44;
    --shadow:0 18px 40px rgba(0,0,0,0.35);
    --chip-bg:rgba(15,23,42,0.75);
    --glass:rgba(15,23,42,0.88);
  }
}

/* Print */
@media print{
  body{overflow:visible}
  .nav,.topbar,.notes,.overlay,.modal,.layers,.laser-dot,.progress{display:none !important}
  .slide-container{height:auto}
  .slide{
    position:relative;opacity:1;transform:none;
    page-break-after:always;
    height:auto;min-height:100vh;
    box-shadow:none;
  }
}



